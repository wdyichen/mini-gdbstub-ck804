#include <assert.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <stdint.h>
#include "gdbstub.h"
#include "conn.h"
#include "gdb_signal.h"
#include "utils/csum.h"
#include "utils/translate.h"
#ifdef __MINGW32__
#include <windows.h>
#endif

struct gdbstub_private {
    conn_t conn;

#ifdef __MINGW32__
    DWORD tid;
    HANDLE thnd;
#else
    pthread_t tid;
#endif
    bool async_io_enable;
    void *args;
};

// include xml-descriptor for target core
static const unsigned char CSKY_CK804_TARGET_XML[] = {
0x3C, 0x3F, 0x78, 0x6D, 0x6C, 0x20, 0x76, 0x65, 0x72, 0x73, 0x69, 0x6F, 0x6E, 
0x3D, 0x22, 0x31, 0x2E, 0x30, 0x22, 0x3F, 0x3E, 0x0A, 0x3C, 0x74, 0x61, 0x72, 0x67, 0x65, 0x74, 
0x3E, 0x0A, 0x20, 0x20, 0x3C, 0x61, 0x72, 0x63, 0x68, 0x69, 0x74, 0x65, 0x63, 0x74, 0x75, 0x72, 
0x65, 0x3E, 0x63, 0x73, 0x6B, 0x79, 0x3C, 0x2F, 0x61, 0x72, 0x63, 0x68, 0x69, 0x74, 0x65, 0x63, 
0x74, 0x75, 0x72, 0x65, 0x3E, 0x0A, 0x20, 0x20, 0x3C, 0x66, 0x65, 0x61, 0x74, 0x75, 0x72, 0x65, 
0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x6F, 0x72, 0x67, 0x2E, 0x67, 0x6E, 0x75, 0x2E, 0x63, 
0x73, 0x6B, 0x79, 0x2E, 0x61, 0x62, 0x69, 0x76, 0x32, 0x2E, 0x67, 0x70, 0x72, 0x22, 0x3E, 0x0A, 
0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 
0x30, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 
0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x30, 0x22, 0x20, 0x20, 0x67, 0x72, 0x6F, 
0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 
0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x31, 0x22, 0x20, 0x20, 0x62, 
0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 
0x75, 0x6D, 0x3D, 0x22, 0x31, 0x22, 0x20, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 
0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 
0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x32, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 
0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x32, 
0x22, 0x20, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 
0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 
0x72, 0x33, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 
0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x33, 0x22, 0x20, 0x20, 0x67, 0x72, 
0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 
0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x34, 0x22, 0x20, 0x20, 
0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 
0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x34, 0x22, 0x20, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 
0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 
0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x35, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 
0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 
0x35, 0x22, 0x20, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 
0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 
0x22, 0x72, 0x36, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 
0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x36, 0x22, 0x20, 0x20, 0x67, 
0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 
0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x37, 0x22, 0x20, 
0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 
0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x37, 0x22, 0x20, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 
0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 
0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x38, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 
0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 
0x22, 0x38, 0x22, 0x20, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 
0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 
0x3D, 0x22, 0x72, 0x39, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 
0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x39, 0x22, 0x20, 0x20, 
0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 
0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x31, 0x30, 
0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 
0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x31, 0x30, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 
0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 
0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x31, 0x31, 0x22, 0x20, 0x62, 0x69, 0x74, 
0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 
0x3D, 0x22, 0x31, 0x31, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 
0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 
0x65, 0x3D, 0x22, 0x72, 0x31, 0x32, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 
0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x31, 0x32, 0x22, 
0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 
0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x31, 
0x33, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 
0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x31, 0x33, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 
0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 
0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x31, 0x34, 0x22, 0x20, 0x62, 0x69, 
0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 
0x6D, 0x3D, 0x22, 0x31, 0x34, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 
0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 
0x6D, 0x65, 0x3D, 0x22, 0x72, 0x31, 0x35, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 
0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x31, 0x35, 
0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 
0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 
0x31, 0x36, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 
0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x31, 0x36, 0x22, 0x20, 0x67, 0x72, 0x6F, 
0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 
0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x31, 0x37, 0x22, 0x20, 0x62, 
0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 
0x75, 0x6D, 0x3D, 0x22, 0x31, 0x37, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 
0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 
0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x31, 0x38, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 
0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x31, 
0x38, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 
0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 
0x72, 0x31, 0x39, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 
0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x31, 0x39, 0x22, 0x20, 0x67, 0x72, 
0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 
0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x32, 0x30, 0x22, 0x20, 
0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 
0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x32, 0x30, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 
0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 
0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x32, 0x31, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 
0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 
0x32, 0x31, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 
0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 
0x22, 0x72, 0x32, 0x32, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 
0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x32, 0x32, 0x22, 0x20, 0x67, 
0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 
0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x32, 0x33, 0x22, 
0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 
0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x32, 0x33, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 
0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 
0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x32, 0x34, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 
0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 
0x22, 0x32, 0x34, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 
0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 
0x3D, 0x22, 0x72, 0x32, 0x35, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 
0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x32, 0x35, 0x22, 0x20, 
0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 
0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x32, 0x36, 
0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 
0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x32, 0x36, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 
0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 
0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x32, 0x37, 0x22, 0x20, 0x62, 0x69, 0x74, 
0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 
0x3D, 0x22, 0x32, 0x37, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 
0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 
0x65, 0x3D, 0x22, 0x72, 0x32, 0x38, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 
0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x32, 0x38, 0x22, 
0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 
0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x32, 
0x39, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 
0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x32, 0x39, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 
0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 
0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x72, 0x33, 0x30, 0x22, 0x20, 0x62, 0x69, 
0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 
0x6D, 0x3D, 0x22, 0x33, 0x30, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 
0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 
0x6D, 0x65, 0x3D, 0x22, 0x72, 0x33, 0x31, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 
0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x33, 0x31, 
0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x67, 0x70, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 
0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x70, 
0x63, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 
0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x37, 0x32, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 
0x20, 0x3C, 0x2F, 0x66, 0x65, 0x61, 0x74, 0x75, 0x72, 0x65, 0x3E, 0x0A, 0x20, 0x20, 0x3C, 0x66, 
0x65, 0x61, 0x74, 0x75, 0x72, 0x65, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x6F, 0x72, 0x67, 
0x2E, 0x67, 0x6E, 0x75, 0x2E, 0x63, 0x73, 0x6B, 0x79, 0x2E, 0x61, 0x62, 0x69, 0x76, 0x32, 0x2E, 
0x66, 0x70, 0x75, 0x22, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x75, 0x6E, 0x69, 0x6F, 0x6E, 
0x20, 0x69, 0x64, 0x3D, 0x22, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x33, 0x32, 0x5F, 0x75, 0x6E, 0x69, 
0x6F, 0x6E, 0x22, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x66, 0x69, 0x65, 0x6C, 
0x64, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x22, 0x20, 0x74, 
0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 0x65, 0x65, 0x65, 0x5F, 0x73, 0x69, 0x6E, 0x67, 0x6C, 0x65, 
0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x66, 0x69, 0x65, 0x6C, 0x64, 
0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x75, 0x69, 0x6E, 0x74, 0x33, 0x32, 0x22, 0x20, 0x74, 
0x79, 0x70, 0x65, 0x3D, 0x22, 0x75, 0x69, 0x6E, 0x74, 0x33, 0x32, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 
0x20, 0x20, 0x20, 0x3C, 0x2F, 0x75, 0x6E, 0x69, 0x6F, 0x6E, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 
0x3C, 0x21, 0x2D, 0x2D, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x20, 0x72, 0x65, 0x67, 0x69, 0x73, 0x74, 
0x65, 0x72, 0x2D, 0x2D, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 
0x61, 0x6D, 0x65, 0x3D, 0x22, 0x66, 0x72, 0x30, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 
0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 
0x34, 0x30, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x66, 0x70, 0x75, 0x22, 0x20, 
0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x33, 0x32, 0x5F, 0x75, 0x6E, 
0x69, 0x6F, 0x6E, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 
0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x66, 0x72, 0x31, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 
0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 
0x22, 0x34, 0x31, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x66, 0x70, 0x75, 0x22, 
0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x33, 0x32, 0x5F, 0x75, 
0x6E, 0x69, 0x6F, 0x6E, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 
0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x66, 0x72, 0x32, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 
0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 
0x3D, 0x22, 0x34, 0x32, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x66, 0x70, 0x75, 
0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x33, 0x32, 0x5F, 
0x75, 0x6E, 0x69, 0x6F, 0x6E, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 
0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x66, 0x72, 0x33, 0x22, 0x20, 0x20, 0x62, 0x69, 
0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 
0x6D, 0x3D, 0x22, 0x34, 0x33, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x66, 0x70, 
0x75, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x33, 0x32, 
0x5F, 0x75, 0x6E, 0x69, 0x6F, 0x6E, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 
0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x66, 0x72, 0x34, 0x22, 0x20, 0x20, 0x62, 
0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 
0x75, 0x6D, 0x3D, 0x22, 0x34, 0x34, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x66, 
0x70, 0x75, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x33, 
0x32, 0x5F, 0x75, 0x6E, 0x69, 0x6F, 0x6E, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 
0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x66, 0x72, 0x35, 0x22, 0x20, 0x20, 
0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 
0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x34, 0x35, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 
0x66, 0x70, 0x75, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x66, 0x6C, 0x6F, 0x61, 0x74, 
0x33, 0x32, 0x5F, 0x75, 0x6E, 0x69, 0x6F, 0x6E, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 
0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x66, 0x72, 0x36, 0x22, 0x20, 
0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 
0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x34, 0x36, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 
0x22, 0x66, 0x70, 0x75, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x66, 0x6C, 0x6F, 0x61, 
0x74, 0x33, 0x32, 0x5F, 0x75, 0x6E, 0x69, 0x6F, 0x6E, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 
0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x66, 0x72, 0x37, 0x22, 
0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 
0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x34, 0x37, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 
0x3D, 0x22, 0x66, 0x70, 0x75, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x66, 0x6C, 0x6F, 
0x61, 0x74, 0x33, 0x32, 0x5F, 0x75, 0x6E, 0x69, 0x6F, 0x6E, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 
0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x66, 0x72, 0x38, 
0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 
0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x34, 0x38, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 
0x70, 0x3D, 0x22, 0x66, 0x70, 0x75, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x66, 0x6C, 
0x6F, 0x61, 0x74, 0x33, 0x32, 0x5F, 0x75, 0x6E, 0x69, 0x6F, 0x6E, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 
0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x66, 0x72, 
0x39, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 
0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x34, 0x39, 0x22, 0x20, 0x67, 0x72, 0x6F, 
0x75, 0x70, 0x3D, 0x22, 0x66, 0x70, 0x75, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x66, 
0x6C, 0x6F, 0x61, 0x74, 0x33, 0x32, 0x5F, 0x75, 0x6E, 0x69, 0x6F, 0x6E, 0x22, 0x2F, 0x3E, 0x0A, 
0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x66, 
0x72, 0x31, 0x30, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 
0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x35, 0x30, 0x22, 0x20, 0x67, 0x72, 
0x6F, 0x75, 0x70, 0x3D, 0x22, 0x66, 0x70, 0x75, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 
0x66, 0x6C, 0x6F, 0x61, 0x74, 0x33, 0x32, 0x5F, 0x75, 0x6E, 0x69, 0x6F, 0x6E, 0x22, 0x2F, 0x3E, 
0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 
0x66, 0x72, 0x31, 0x31, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 
0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x35, 0x31, 0x22, 0x20, 0x67, 
0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x66, 0x70, 0x75, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 
0x22, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x33, 0x32, 0x5F, 0x75, 0x6E, 0x69, 0x6F, 0x6E, 0x22, 0x2F, 
0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 
0x22, 0x66, 0x72, 0x31, 0x32, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 
0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x35, 0x32, 0x22, 0x20, 
0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x66, 0x70, 0x75, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 
0x3D, 0x22, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x33, 0x32, 0x5F, 0x75, 0x6E, 0x69, 0x6F, 0x6E, 0x22, 
0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 
0x3D, 0x22, 0x66, 0x72, 0x31, 0x33, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 
0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x35, 0x33, 0x22, 
0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x66, 0x70, 0x75, 0x22, 0x20, 0x74, 0x79, 0x70, 
0x65, 0x3D, 0x22, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x33, 0x32, 0x5F, 0x75, 0x6E, 0x69, 0x6F, 0x6E, 
0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 
0x65, 0x3D, 0x22, 0x66, 0x72, 0x31, 0x34, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 
0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x35, 0x34, 
0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x66, 0x70, 0x75, 0x22, 0x20, 0x74, 0x79, 
0x70, 0x65, 0x3D, 0x22, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x33, 0x32, 0x5F, 0x75, 0x6E, 0x69, 0x6F, 
0x6E, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 
0x6D, 0x65, 0x3D, 0x22, 0x66, 0x72, 0x31, 0x35, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 
0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x35, 
0x35, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x66, 0x70, 0x75, 0x22, 0x20, 0x74, 
0x79, 0x70, 0x65, 0x3D, 0x22, 0x66, 0x6C, 0x6F, 0x61, 0x74, 0x33, 0x32, 0x5F, 0x75, 0x6E, 0x69, 
0x6F, 0x6E, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x3C, 0x2F, 0x66, 0x65, 0x61, 0x74, 0x75, 0x72, 
0x65, 0x3E, 0x0A, 0x20, 0x20, 0x3C, 0x66, 0x65, 0x61, 0x74, 0x75, 0x72, 0x65, 0x20, 0x6E, 0x61, 
0x6D, 0x65, 0x3D, 0x22, 0x6F, 0x72, 0x67, 0x2E, 0x67, 0x6E, 0x75, 0x2E, 0x63, 0x73, 0x6B, 0x79, 
0x2E, 0x61, 0x62, 0x69, 0x76, 0x32, 0x2E, 0x63, 0x72, 0x22, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 
0x3C, 0x66, 0x6C, 0x61, 0x67, 0x73, 0x20, 0x69, 0x64, 0x3D, 0x22, 0x63, 0x6B, 0x63, 0x70, 0x75, 
0x5F, 0x70, 0x73, 0x72, 0x22, 0x20, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x34, 0x22, 0x3E, 0x0A, 
0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x66, 0x69, 0x65, 0x6C, 0x64, 0x20, 0x6E, 0x61, 0x6D, 
0x65, 0x3D, 0x22, 0x43, 0x5B, 0x30, 0x5D, 0x22, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 
0x73, 0x74, 0x61, 0x72, 0x74, 0x3D, 0x22, 0x30, 0x22, 0x20, 0x20, 0x65, 0x6E, 0x64, 0x3D, 0x22, 
0x30, 0x22, 0x20, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 0x6E, 0x74, 0x38, 0x22, 0x2F, 
0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x66, 0x69, 0x65, 0x6C, 0x64, 0x20, 0x6E, 
0x61, 0x6D, 0x65, 0x3D, 0x22, 0x41, 0x46, 0x5B, 0x31, 0x5D, 0x22, 0x20, 0x20, 0x20, 0x20, 0x20, 
0x20, 0x20, 0x73, 0x74, 0x61, 0x72, 0x74, 0x3D, 0x22, 0x31, 0x22, 0x20, 0x20, 0x65, 0x6E, 0x64, 
0x3D, 0x22, 0x31, 0x22, 0x20, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 0x6E, 0x74, 0x38, 
0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x66, 0x69, 0x65, 0x6C, 0x64, 
0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x49, 0x45, 0x5B, 0x36, 0x5D, 0x22, 0x20, 0x20, 0x20, 
0x20, 0x20, 0x20, 0x20, 0x73, 0x74, 0x61, 0x72, 0x74, 0x3D, 0x22, 0x36, 0x22, 0x20, 0x20, 0x65, 
0x6E, 0x64, 0x3D, 0x22, 0x36, 0x22, 0x20, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 0x6E, 
0x74, 0x38, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x66, 0x69, 0x65, 
0x6C, 0x64, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x49, 0x43, 0x5B, 0x37, 0x5D, 0x22, 0x20, 
0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x73, 0x74, 0x61, 0x72, 0x74, 0x3D, 0x22, 0x37, 0x22, 0x20, 
0x20, 0x65, 0x6E, 0x64, 0x3D, 0x22, 0x37, 0x22, 0x20, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 
0x69, 0x6E, 0x74, 0x38, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x66, 
0x69, 0x65, 0x6C, 0x64, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x45, 0x45, 0x5B, 0x38, 0x5D, 
0x22, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x73, 0x74, 0x61, 0x72, 0x74, 0x3D, 0x22, 0x38, 
0x22, 0x20, 0x20, 0x65, 0x6E, 0x64, 0x3D, 0x22, 0x38, 0x22, 0x20, 0x20, 0x74, 0x79, 0x70, 0x65, 
0x3D, 0x22, 0x69, 0x6E, 0x74, 0x38, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 
0x3C, 0x66, 0x69, 0x65, 0x6C, 0x64, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x4D, 0x4D, 0x5B, 
0x39, 0x5D, 0x22, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x73, 0x74, 0x61, 0x72, 0x74, 0x3D, 
0x22, 0x39, 0x22, 0x20, 0x20, 0x65, 0x6E, 0x64, 0x3D, 0x22, 0x39, 0x22, 0x20, 0x20, 0x74, 0x79, 
0x70, 0x65, 0x3D, 0x22, 0x69, 0x6E, 0x74, 0x38, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 
0x20, 0x20, 0x3C, 0x66, 0x69, 0x65, 0x6C, 0x64, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x54, 
0x4D, 0x5B, 0x31, 0x35, 0x3A, 0x31, 0x34, 0x5D, 0x22, 0x20, 0x20, 0x20, 0x73, 0x74, 0x61, 0x72, 
0x74, 0x3D, 0x22, 0x31, 0x34, 0x22, 0x20, 0x65, 0x6E, 0x64, 0x3D, 0x22, 0x31, 0x35, 
0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 0x6E, 0x74, 0x38, 0x22, 
0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x66, 0x69, 0x65, 0x6C, 0x64, 0x20, 
0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x56, 0x45, 0x43, 0x5B, 0x32, 0x33, 0x3A, 0x31, 0x36, 0x5D, 
0x22, 0x20, 0x20, 0x73, 0x74, 0x61, 0x72, 0x74, 0x3D, 0x22, 0x31, 0x36, 0x22, 0x20, 0x65, 0x6E, 
0x64, 0x3D, 0x22, 0x32, 0x33, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 0x6E, 0x74, 
0x38, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x66, 0x69, 0x65, 0x6C, 
0x64, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x53, 0x56, 0x5B, 0x32, 0x35, 0x5D, 0x22, 0x20, 
0x20, 0x20, 0x20, 0x20, 0x20, 0x73, 0x74, 0x61, 0x72, 0x74, 0x3D, 0x22, 0x32, 0x35, 0x22, 0x20, 
0x65, 0x6E, 0x64, 0x3D, 0x22, 0x32, 0x35, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 
0x6E, 0x74, 0x38, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x66, 0x69, 
0x65, 0x6C, 0x64, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x53, 0x44, 0x5B, 0x32, 0x36, 0x5D, 
0x22, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x73, 0x74, 0x61, 0x72, 0x74, 0x3D, 0x22, 0x32, 0x36, 
0x22, 0x20, 0x65, 0x6E, 0x64, 0x3D, 0x22, 0x32, 0x36, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 
0x22, 0x69, 0x6E, 0x74, 0x38, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3C, 
0x66, 0x69, 0x65, 0x6C, 0x64, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x53, 0x43, 0x5B, 0x32, 
0x37, 0x5D, 0x22, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x73, 0x74, 0x61, 0x72, 0x74, 0x3D, 0x22, 
0x32, 0x37, 0x22, 0x20, 0x65, 0x6E, 0x64, 0x3D, 0x22, 0x32, 0x37, 0x22, 0x20, 0x74, 0x79, 0x70, 
0x65, 0x3D, 0x22, 0x69, 0x6E, 0x74, 0x38, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 
0x20, 0x3C, 0x66, 0x69, 0x65, 0x6C, 0x64, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x48, 0x53, 
0x5B, 0x32, 0x38, 0x5D, 0x22, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x73, 0x74, 0x61, 0x72, 0x74, 
0x3D, 0x22, 0x32, 0x38, 0x22, 0x20, 0x65, 0x6E, 0x64, 0x3D, 0x22, 0x32, 0x38, 0x22, 0x20, 0x74, 
0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 0x6E, 0x74, 0x38, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 
0x20, 0x20, 0x20, 0x3C, 0x66, 0x69, 0x65, 0x6C, 0x64, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 
0x53, 0x50, 0x5B, 0x32, 0x39, 0x5D, 0x22, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x73, 0x74, 0x61, 
0x72, 0x74, 0x3D, 0x22, 0x32, 0x39, 0x22, 0x20, 0x65, 0x6E, 0x64, 0x3D, 0x22, 0x32, 0x39, 0x22, 
0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 0x6E, 0x74, 0x38, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 
0x20, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x66, 0x69, 0x65, 0x6C, 0x64, 0x20, 0x6E, 0x61, 0x6D, 0x65, 
0x3D, 0x22, 0x54, 0x5B, 0x33, 0x30, 0x5D, 0x22, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x73, 
0x74, 0x61, 0x72, 0x74, 0x3D, 0x22, 0x33, 0x30, 0x22, 0x20, 0x65, 0x6E, 0x64, 0x3D, 0x22, 0x33, 
0x30, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 0x6E, 0x74, 0x38, 0x22, 0x2F, 0x3E, 
0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x66, 0x69, 0x65, 0x6C, 0x64, 0x20, 0x6E, 0x61, 
0x6D, 0x65, 0x3D, 0x22, 0x53, 0x5B, 0x33, 0x31, 0x5D, 0x22, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 
0x20, 0x73, 0x74, 0x61, 0x72, 0x74, 0x3D, 0x22, 0x33, 0x31, 0x22, 0x20, 0x65, 0x6E, 0x64, 0x3D, 
0x22, 0x33, 0x31, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 0x6E, 0x74, 0x38, 0x22, 
0x2F, 0x3E, 0x0A, 0x09, 0x3C, 0x2F, 0x66, 0x6C, 0x61, 0x67, 0x73, 0x3E, 0x0A, 0x20, 0x20, 0x20, 
0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x70, 0x73, 0x72, 0x22, 
0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 
0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x38, 0x39, 0x22, 0x20, 0x20, 0x67, 0x72, 0x6F, 0x75, 
0x70, 0x3D, 0x22, 0x63, 0x72, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x63, 0x6B, 0x63, 
0x70, 0x75, 0x5F, 0x70, 0x73, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 
0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x76, 0x62, 0x72, 0x22, 0x20, 0x20, 0x62, 
0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 
0x75, 0x6D, 0x3D, 0x22, 0x39, 0x30, 0x22, 0x20, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 
0x63, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 
0x61, 0x6D, 0x65, 0x3D, 0x22, 0x65, 0x70, 0x73, 0x72, 0x22, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 
0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 
0x39, 0x31, 0x22, 0x20, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x63, 0x72, 0x22, 0x2F, 
0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 
0x22, 0x65, 0x70, 0x63, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 
0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x39, 0x33, 0x22, 0x20, 
0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x63, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 
0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x63, 0x70, 0x75, 
0x69, 0x64, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 
0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x31, 0x30, 0x32, 0x22, 0x20, 0x67, 
0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x63, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 
0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x63, 0x63, 0x72, 0x22, 0x20, 
0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 
0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x31, 0x30, 0x37, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 
0x3D, 0x22, 0x63, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 
0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x63, 0x61, 0x70, 0x72, 0x22, 0x20, 0x20, 0x62, 0x69, 
0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 
0x6D, 0x3D, 0x22, 0x31, 0x30, 0x38, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x63, 
0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 
0x6D, 0x65, 0x3D, 0x22, 0x70, 0x61, 0x63, 0x72, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 
0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 
0x31, 0x30, 0x39, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x63, 0x72, 0x22, 0x2F, 
0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 
0x22, 0x70, 0x72, 0x73, 0x72, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 
0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x31, 0x31, 0x30, 
0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x63, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 
0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x63, 0x68, 
0x72, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 
0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x31, 0x32, 0x30, 0x22, 0x20, 0x67, 0x72, 
0x6F, 0x75, 0x70, 0x3D, 0x22, 0x63, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 
0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x69, 0x6E, 0x74, 0x5F, 0x73, 0x70, 
0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 
0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x32, 0x30, 0x34, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 
0x20, 0x3C, 0x2F, 0x66, 0x65, 0x61, 0x74, 0x75, 0x72, 0x65, 0x3E, 0x0A, 0x20, 0x20, 0x3C, 0x66, 
0x65, 0x61, 0x74, 0x75, 0x72, 0x65, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x6F, 0x72, 0x67, 
0x2E, 0x67, 0x6E, 0x75, 0x2E, 0x63, 0x73, 0x6B, 0x79, 0x2E, 0x61, 0x62, 0x69, 0x76, 0x32, 0x2E, 
0x66, 0x76, 0x63, 0x72, 0x22, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 
0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x66, 0x63, 0x72, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 
0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 
0x22, 0x31, 0x32, 0x31, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x66, 0x76, 0x63, 
0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 
0x6D, 0x65, 0x3D, 0x22, 0x66, 0x69, 0x64, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 
0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x31, 
0x32, 0x32, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x66, 0x76, 0x63, 0x72, 0x22, 
0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 
0x3D, 0x22, 0x66, 0x65, 0x73, 0x72, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 
0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x31, 0x32, 
0x33, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x66, 0x76, 0x63, 0x72, 0x22, 0x2F, 
0x3E, 0x0A, 0x20, 0x20, 0x3C, 0x2F, 0x66, 0x65, 0x61, 0x74, 0x75, 0x72, 0x65, 0x3E, 0x0A, 0x20, 
0x20, 0x3C, 0x66, 0x65, 0x61, 0x74, 0x75, 0x72, 0x65, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 
0x6F, 0x72, 0x67, 0x2E, 0x67, 0x6E, 0x75, 0x2E, 0x63, 0x73, 0x6B, 0x79, 0x2E, 0x61, 0x62, 0x69, 
0x76, 0x32, 0x2E, 0x74, 0x65, 0x65, 0x22, 0x3E, 0x0A, 0x09, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 
0x61, 0x6D, 0x65, 0x3D, 0x22, 0x6E, 0x74, 0x5F, 0x75, 0x73, 0x70, 0x22, 0x20, 0x20, 0x62, 0x69, 
0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 
0x6D, 0x3D, 0x22, 0x31, 0x32, 0x37, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x72, 
0x65, 0x65, 0x22, 0x2F, 0x3E, 0x0A, 0x09, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 
0x3D, 0x22, 0x65, 0x62, 0x72, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 
0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x31, 0x39, 0x30, 
0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x63, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x09, 
0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x64, 0x63, 0x72, 0x22, 0x20, 
0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 
0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x32, 0x32, 0x39, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 
0x3D, 0x22, 0x63, 0x72, 0x22, 0x2F, 0x3E, 0x0A, 0x09, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 
0x6D, 0x65, 0x3D, 0x22, 0x74, 0x5F, 0x75, 0x73, 0x70, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 
0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 
0x22, 0x32, 0x32, 0x38, 0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x74, 0x65, 0x65, 
0x22, 0x2F, 0x3E, 0x0A, 0x09, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 
0x74, 0x5F, 0x70, 0x63, 0x72, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 
0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x6E, 0x75, 0x6D, 0x3D, 0x22, 0x32, 0x33, 0x30, 
0x22, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x74, 0x65, 0x65, 0x22, 0x2F, 0x3E, 0x0A, 
0x20, 0x20, 0x3C, 0x2F, 0x66, 0x65, 0x61, 0x74, 0x75, 0x72, 0x65, 0x3E, 0x0A, 0x20, 0x20, 0x3C, 
0x66, 0x65, 0x61, 0x74, 0x75, 0x72, 0x65, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x6F, 0x72, 
0x67, 0x2E, 0x67, 0x6E, 0x75, 0x2E, 0x63, 0x73, 0x6B, 0x79, 0x2E, 0x70, 0x73, 0x65, 0x75, 0x64, 
0x6F, 0x22, 0x3E, 0x0A, 0x09, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 
0x74, 0x5F, 0x70, 0x73, 0x72, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 
0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x73, 0x3D, 0x22, 0x38, 0x39, 0x22, 0x20, 0x20, 
0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x74, 0x65, 0x65, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 
0x3D, 0x22, 0x69, 0x6E, 0x74, 0x33, 0x32, 0x22, 0x20, 0x65, 0x6E, 0x76, 0x3D, 0x22, 0x74, 0x65, 
0x65, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 
0x6D, 0x65, 0x3D, 0x22, 0x74, 0x5F, 0x76, 0x62, 0x72, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 
0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x73, 0x3D, 0x22, 0x39, 
0x30, 0x22, 0x20, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x74, 0x65, 0x65, 0x22, 0x20, 
0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 0x6E, 0x74, 0x33, 0x32, 0x22, 0x20, 0x65, 0x6E, 0x76, 
0x3D, 0x22, 0x74, 0x65, 0x65, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 
0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x74, 0x5F, 0x65, 0x70, 0x73, 0x72, 0x22, 0x20, 
0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 
0x73, 0x3D, 0x22, 0x39, 0x31, 0x22, 0x20, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x74, 
0x65, 0x65, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 0x6E, 0x74, 0x33, 0x32, 0x22, 
0x20, 0x65, 0x6E, 0x76, 0x3D, 0x22, 0x74, 0x65, 0x65, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 
0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x74, 0x5F, 0x65, 0x70, 
0x63, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 
0x20, 0x72, 0x65, 0x67, 0x73, 0x3D, 0x22, 0x39, 0x33, 0x22, 0x20, 0x20, 0x67, 0x72, 0x6F, 0x75, 
0x70, 0x3D, 0x22, 0x74, 0x65, 0x65, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 0x6E, 
0x74, 0x33, 0x32, 0x22, 0x20, 0x65, 0x6E, 0x76, 0x3D, 0x22, 0x74, 0x65, 0x65, 0x22, 0x2F, 0x3E, 
0x0A, 0x09, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x74, 0x5F, 0x65, 
0x62, 0x72, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 
0x22, 0x20, 0x72, 0x65, 0x67, 0x73, 0x3D, 0x22, 0x31, 0x39, 0x30, 0x22, 0x20, 0x67, 0x72, 0x6F, 
0x75, 0x70, 0x3D, 0x22, 0x74, 0x65, 0x65, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 
0x6E, 0x74, 0x33, 0x32, 0x22, 0x20, 0x65, 0x6E, 0x76, 0x3D, 0x22, 0x74, 0x65, 0x65, 0x22, 0x2F, 
0x3E, 0x0A, 0x09, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x6E, 0x74, 
0x5F, 0x70, 0x73, 0x72, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 
0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x73, 0x3D, 0x22, 0x38, 0x39, 0x22, 0x20, 0x20, 0x67, 
0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x72, 0x65, 0x65, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 
0x22, 0x69, 0x6E, 0x74, 0x33, 0x32, 0x22, 0x20, 0x65, 0x6E, 0x76, 0x3D, 0x22, 0x72, 0x65, 0x65, 
0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 
0x65, 0x3D, 0x22, 0x6E, 0x74, 0x5F, 0x76, 0x62, 0x72, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 
0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x73, 0x3D, 0x22, 0x39, 
0x30, 0x22, 0x20, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x72, 0x65, 0x65, 0x22, 0x20, 
0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 0x6E, 0x74, 0x33, 0x32, 0x22, 0x20, 0x65, 0x6E, 0x76, 
0x3D, 0x22, 0x72, 0x65, 0x65, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x72, 0x65, 
0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x6E, 0x74, 0x5F, 0x65, 0x70, 0x73, 0x72, 0x22, 
0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 
0x67, 0x73, 0x3D, 0x22, 0x39, 0x31, 0x22, 0x20, 0x20, 0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 
0x72, 0x65, 0x65, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 0x69, 0x6E, 0x74, 0x33, 0x32, 
0x22, 0x20, 0x65, 0x6E, 0x76, 0x3D, 0x22, 0x72, 0x65, 0x65, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 
0x20, 0x20, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x6E, 0x74, 0x5F, 
0x65, 0x70, 0x63, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 0x22, 0x33, 
0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x73, 0x3D, 0x22, 0x39, 0x33, 0x22, 0x20, 0x20, 0x67, 0x72, 
0x6F, 0x75, 0x70, 0x3D, 0x22, 0x72, 0x65, 0x65, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3D, 0x22, 
0x69, 0x6E, 0x74, 0x33, 0x32, 0x22, 0x20, 0x65, 0x6E, 0x76, 0x3D, 0x22, 0x72, 0x65, 0x65, 0x22, 
0x2F, 0x3E, 0x0A, 0x09, 0x3C, 0x72, 0x65, 0x67, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x6E, 
0x74, 0x5F, 0x65, 0x62, 0x72, 0x22, 0x20, 0x20, 0x62, 0x69, 0x74, 0x73, 0x69, 0x7A, 0x65, 0x3D, 
0x22, 0x33, 0x32, 0x22, 0x20, 0x72, 0x65, 0x67, 0x73, 0x3D, 0x22, 0x31, 0x39, 0x30, 0x22, 0x20, 
0x67, 0x72, 0x6F, 0x75, 0x70, 0x3D, 0x22, 0x72, 0x65, 0x65, 0x22, 0x20, 0x74, 0x79, 0x70, 0x65, 
0x3D, 0x22, 0x69, 0x6E, 0x74, 0x33, 0x32, 0x22, 0x20, 0x65, 0x6E, 0x76, 0x3D, 0x22, 0x72, 0x65, 
0x65, 0x22, 0x2F, 0x3E, 0x0A, 0x20, 0x20, 0x3C, 0x2F, 0x66, 0x65, 0x61, 0x74, 0x75, 0x72, 0x65, 
0x3E, 0x0A, 0x3C, 0x2F, 0x74, 0x61, 0x72, 0x67, 0x65, 0x74, 0x3E, 0x0A, 0x0
};

static inline void async_io_enable(struct gdbstub_private *priv)
{
    __atomic_store_n(&priv->async_io_enable, true, __ATOMIC_RELAXED);
}

static inline void async_io_disable(struct gdbstub_private *priv)
{
    __atomic_store_n(&priv->async_io_enable, false, __ATOMIC_RELAXED);
}

static inline bool async_io_is_enable(struct gdbstub_private *priv)
{
    return __atomic_load_n(&priv->async_io_enable, __ATOMIC_RELAXED);
}

static volatile bool thread_stop = false;
#ifdef __MINGW32__
static DWORD socket_reader(void *param)
#else
static void *socket_reader(void *param)
#endif
{
    gdbstub_t *gdbstub = param;
    void *args = gdbstub->priv->args;

    /* This thread will only works when running the gdbstub routine,
     * which won't procees on any packets. In this case, we read packet
     * in another thread to be able to interrupt the gdbstub. */
    while (!__atomic_load_n(&thread_stop, __ATOMIC_RELAXED)) {
        if (async_io_is_enable(gdbstub->priv) &&
            conn_try_recv_intr(&gdbstub->priv->conn)) {
            gdbstub->ops->on_interrupt(args);
        }
    }

#ifdef __MINGW32__
    return 0;
#else
    return NULL;
#endif
}

bool gdbstub_init(gdbstub_t *gdbstub,
                  struct target_ops *ops,
                  arch_info_t arch,
                  char *s)
{
    if (s == NULL || ops == NULL)
        return false;

    memset(gdbstub, 0, sizeof(gdbstub_t));
    gdbstub->ops = ops;
    gdbstub->arch = arch;
    gdbstub->priv = calloc(1, sizeof(struct gdbstub_private));
    if (gdbstub->priv == NULL) {
        return false;
    }
    // This is a naive implementation to parse the string
    char *addr_str = strdup(s);
    char *port_str = strchr(addr_str, ':');
    if (addr_str == NULL || port_str == NULL) {
        free(addr_str);
        return false;
    }

    *port_str = '\0';
    port_str += 1;

    int port;
    if (sscanf(port_str, "%d", &port) <= 0) {
        free(addr_str);
        return false;
    }

    if (!conn_init(&gdbstub->priv->conn, addr_str, port)) {
        free(addr_str);
        return false;
    }
    free(addr_str);

    return true;
}

static void process_reg_read(gdbstub_t *gdbstub, void *args)
{
    char packet_str[MAX_SEND_PACKET_SIZE];
    uint32_t reg_value;
    uint32_t reg_sz = gdbstub->arch.reg_byte;

    assert(sizeof(reg_value) >= gdbstub->arch.reg_byte);

    for (uint32_t i = 0; i < gdbstub->arch.reg_num; i++) {
        int ret = gdbstub->ops->read_reg(args, i, &reg_value);
        if (!ret) {
            hex_to_str((uint8_t *) &reg_value, &packet_str[i * reg_sz * 2],
                       reg_sz);
        } else {
            sprintf(packet_str, "E%d", ret);
            break;
        }
    }
    conn_send_pktstr(&gdbstub->priv->conn, packet_str);
}

static void process_reg_read_one(gdbstub_t *gdbstub, char *payload, void *args)
{
    char packet_str[MAX_SEND_PACKET_SIZE];
    uint32_t regno;
    uint32_t reg_sz = gdbstub->arch.reg_byte;
    uint32_t reg_value;

    assert(sscanf(payload, "%x", &regno) == 1);
    int ret = gdbstub->ops->read_reg(args, regno, &reg_value);
#ifdef DEBUG
    printf("reg read = regno %u data %x\n", regno, reg_value);
#endif
    if (!ret) {
        hex_to_str((uint8_t *) &reg_value, packet_str, reg_sz);
    } else {
        sprintf(packet_str, "E%d", ret);
    }
    conn_send_pktstr(&gdbstub->priv->conn, packet_str);
}

static void process_reg_write(gdbstub_t *gdbstub, char *payload, void *args)
{
    uint32_t reg_value = 0;
    uint32_t reg_sz = gdbstub->arch.reg_byte;

    assert(sizeof(reg_value) >= gdbstub->arch.reg_byte);

    for (uint32_t i = 0; i < gdbstub->arch.reg_num; i++) {
        str_to_hex(&payload[i * reg_sz * 2], (uint8_t *) &reg_value, reg_sz);
#ifdef DEBUG
        printf("reg write = regno %u data %x\n", i, reg_value);
#endif
        int ret = gdbstub->ops->write_reg(args, i, reg_value);
        if (ret) {
            /* FIXME: Even if we fail to modify this register, some
             * registers could be writen before. This may not be
             * an expected behavior. */
            char packet_str[MAX_SEND_PACKET_SIZE];
            sprintf(packet_str, "E%d", ret);
            conn_send_pktstr(&gdbstub->priv->conn, packet_str);
            return;
        }
    }
    conn_send_pktstr(&gdbstub->priv->conn, "OK");
}

static void process_reg_write_one(gdbstub_t *gdbstub, char *payload, void *args)
{
    uint32_t regno;
    uint32_t data;
    char *regno_str = payload;
    char *data_str = strchr(payload, '=');
    if (data_str) {
        *data_str = '\0';
        data_str++;
    }

    assert(strlen(data_str) == gdbstub->arch.reg_byte * 2);
    assert(sizeof(data) >= gdbstub->arch.reg_byte);
    assert(sscanf(regno_str, "%x", &regno) == 1);
    str_to_hex(data_str, (uint8_t *) &data, gdbstub->arch.reg_byte);
#ifdef DEBUG
    printf("reg write = regno %u / data %x\n", regno, data);
#endif
    int ret = gdbstub->ops->write_reg(args, regno, data);
    if (!ret) {
        conn_send_pktstr(&gdbstub->priv->conn, "OK");
    } else {
        char packet_str[MAX_SEND_PACKET_SIZE];
        sprintf(packet_str, "E%d", ret);
        conn_send_pktstr(&gdbstub->priv->conn, packet_str);
    }
}

static void process_mem_read(gdbstub_t *gdbstub, char *payload, void *args)
{
    uint32_t maddr, mlen;
    assert(sscanf(payload, "%x,%x", &maddr, &mlen) == 2);
#ifdef DEBUG
    printf("mem read = addr %x / len %x\n", maddr, mlen);
#endif
    char packet_str[MAX_SEND_PACKET_SIZE];

    uint8_t *mval = malloc(mlen);
    int ret = gdbstub->ops->read_mem(args, maddr, mlen, mval);
    if (!ret) {
        hex_to_str(mval, packet_str, mlen);
    } else {
        sprintf(packet_str, "E%d", ret);
    }
    conn_send_pktstr(&gdbstub->priv->conn, packet_str);
    free(mval);
}

static void process_mem_write(gdbstub_t *gdbstub, char *payload, void *args)
{
    uint32_t maddr, mlen;
    char *content = strchr(payload, ':');
    if (content) {
        *content = '\0';
        content++;
    }
    assert(sscanf(payload, "%x,%x", &maddr, &mlen) == 2);
#ifdef DEBUG
    printf("mem write = addr %x / len %x\n", maddr, mlen);
    printf("mem write = content %s\n", content);
#endif
    uint8_t *mval = malloc(mlen);
    str_to_hex(content, mval, mlen);
    int ret = gdbstub->ops->write_mem(args, maddr, mlen, mval);

    if (!ret) {
        conn_send_pktstr(&gdbstub->priv->conn, "OK");
    } else {
        char packet_str[MAX_SEND_PACKET_SIZE];
        sprintf(packet_str, "E%d", ret);
        conn_send_pktstr(&gdbstub->priv->conn, packet_str);
    }
    free(mval);
}

static void process_mem_xwrite(gdbstub_t *gdbstub,
                               char *payload,
                               uint8_t *packet_end,
                               void *args)
{
    uint32_t maddr, mlen;
    char *content = strchr(payload, ':');
    if (content) {
        *content = '\0';
        content++;
    }
    assert(sscanf(payload, "%x,%x", &maddr, &mlen) == 2);
    assert(unescape(content, (char *) packet_end) == (int) mlen);
#ifdef DEBUG
    printf("mem xwrite = addr %x / len %x\n", maddr, mlen);
    for (uint32_t i = 0; i < mlen; i++) {
        printf("\tmem xwrite, byte %u: %x\n", i, content[i]);
    }
#endif

    gdbstub->ops->write_mem(args, maddr, mlen, content);
    conn_send_pktstr(&gdbstub->priv->conn, "OK");
}
#define TARGET_DESC \
    "l<target version=\"1.0\"><architecture>%s</architecture></target>"

void process_xfer(gdbstub_t *gdbstub, char *s)
{
    char *name = s;
    char *args = strchr(s, ':');
    if (args) {
        *args = '\0';
        args++;
    }
#ifdef DEBUG
    printf("xfer = %s %s\n", name, args);
#endif
    if (!strcmp(name, "features") && gdbstub->arch.target_desc != NULL) {
        /* FIXME: We should check the args */
        char buf[MAX_SEND_PACKET_SIZE + 1];
        if (!strcmp(TARGET_CSKY_CK804, gdbstub->arch.target_desc)) {
            char *pos = strstr(args, "read:target.xml:");
            if (!pos) assert(0);
            pos += strlen("read:target.xml:");
            uint32_t start_pos = strtol(pos, NULL, 16);
            pos = strchr(pos, ',');
            if (!pos) assert(0);
            pos++;
            uint32_t get_length = strtol(pos, NULL, 16);
            if ((sizeof(CSKY_CK804_TARGET_XML) - start_pos) > get_length)//if (0 == start_pos)
                snprintf(buf, 1 + get_length + 1, "m%s", CSKY_CK804_TARGET_XML + start_pos);
            else
                snprintf(buf, 1 + get_length + 1, "l%s", CSKY_CK804_TARGET_XML + start_pos);
#ifdef __MINGW32__
            //windows's snprintf dont't append zero to tailer
            if (strlen((char *)(CSKY_CK804_TARGET_XML + start_pos)) > get_length)
            {
                buf[1 + get_length] = '\0';
            }
#endif
            conn_send_pktstr(&gdbstub->priv->conn, buf);
        } else {
            sprintf(buf, TARGET_DESC, gdbstub->arch.target_desc);
            conn_send_pktstr(&gdbstub->priv->conn, buf);
        }
    } else {
        conn_send_pktstr(&gdbstub->priv->conn, "");
    }
}

static void process_query(gdbstub_t *gdbstub, char *payload)
{
    char *name = payload;
    char *args = strchr(payload, ':');
    if (args) {
        *args = '\0';
        args++;
    }
#ifdef DEBUG
    printf("query = %s %s\n", name, args);
#endif

    /* PacketSize means hex 1000 -> dec 4096 */
    if (!strcmp(name, "Supported")) {
        if (gdbstub->arch.target_desc != NULL)
            conn_send_pktstr(&gdbstub->priv->conn,
                             "PacketSize=1000;qXfer:features:read+");
        else
            conn_send_pktstr(&gdbstub->priv->conn, "PacketSize=1000");
    } else if (!strcmp(name, "Attached")) {
        /* assume attached to an existing process */
        conn_send_pktstr(&gdbstub->priv->conn, "1");
    } else if (!strcmp(name, "Xfer")) {
        process_xfer(gdbstub, args);
    } else if (!strcmp(name, "Symbol")) {
        conn_send_pktstr(&gdbstub->priv->conn, "OK");
    } else {
        conn_send_pktstr(&gdbstub->priv->conn, "");
    }
}

#define VCONT_DESC "vCont;%s%s"
static void process_vpacket(gdbstub_t *gdbstub, char *payload)
{
    char *name = payload;
    char *args = strchr(payload, ':');
    if (args) {
        *args = '\0';
        args++;
    }
#ifdef DEBUG
    printf("vpacket = %s %s\n", name, args);
#endif

    if (!strcmp("Cont?", name)) {
        char packet_str[MAX_SEND_PACKET_SIZE];
        char *str_s = (gdbstub->ops->stepi == NULL) ? "" : "s;";
        char *str_c = (gdbstub->ops->cont == NULL) ? "" : "c;";
        sprintf(packet_str, VCONT_DESC, str_s, str_c);

        conn_send_pktstr(&gdbstub->priv->conn, packet_str);
    } else {
        conn_send_pktstr(&gdbstub->priv->conn, "");
    }
}

static void process_del_break_points(gdbstub_t *gdbstub,
                                     char *payload,
                                     void *args)
{
    uint32_t type, addr, kind;
    assert(sscanf(payload, "%x,%x,%x", &type, &addr, &kind) == 3);

#ifdef DEBUG
    printf("remove breakpoints = %x %x %x\n", type, addr, kind);
#endif

    bool ret = gdbstub->ops->del_bp(args, addr, type);
    if (ret)
        conn_send_pktstr(&gdbstub->priv->conn, "OK");
    else
        conn_send_pktstr(&gdbstub->priv->conn, "E01");
}

static void process_set_break_points(gdbstub_t *gdbstub,
                                     char *payload,
                                     void *args)
{
    uint32_t type, addr, kind;
    assert(sscanf(payload, "%x,%x,%x", &type, &addr, &kind) == 3);

#ifdef DEBUG
    printf("set breakpoints = %x %x %x\n", type, addr, kind);
#endif

    bool ret = gdbstub->ops->set_bp(args, addr, type);
    if (ret)
        conn_send_pktstr(&gdbstub->priv->conn, "OK");
    else
        conn_send_pktstr(&gdbstub->priv->conn, "E01");
}


static bool packet_csum_verify(packet_t *inpkt)
{
    /* We add extra 1 for leading '$' and minus extra 1 for trailing '#' */
    uint8_t csum_rslt = compute_checksum((char *) inpkt->data + 1,
                                         inpkt->end_pos - CSUM_SIZE - 1);
    uint8_t csum_expected;
    str_to_hex((char *) &inpkt->data[inpkt->end_pos - CSUM_SIZE + 1],
               &csum_expected, sizeof(uint8_t));
#ifdef DEBUG
    printf("csum rslt = %x / csum expected = %s / ", csum_rslt,
           &inpkt->data[inpkt->end_pos - CSUM_SIZE + 1]);
    printf("csum expected = %x \n", csum_expected);
#endif
    return csum_rslt == csum_expected;
}

static gdb_event_t gdbstub_process_packet(gdbstub_t *gdbstub,
                                          packet_t *inpkt,
                                          void *args)
{
    assert(inpkt->data[0] == '$');
    assert(packet_csum_verify(inpkt));

    /* After checking the checksum result, ignore those bytes */
    inpkt->data[inpkt->end_pos - CSUM_SIZE] = 0;
    uint8_t request = inpkt->data[1];
    char *payload = (char *) &inpkt->data[2];
    gdb_event_t event = EVENT_NONE;

    switch (request) {
    case 'c':
        if (gdbstub->ops->cont != NULL) {
            event = EVENT_CONT;
        } else {
            conn_send_pktstr(&gdbstub->priv->conn, "");
        }
        break;
    case 'g':
        if (gdbstub->ops->read_reg != NULL) {
            process_reg_read(gdbstub, args);
        } else {
            conn_send_pktstr(&gdbstub->priv->conn, "");
        }
        break;
    case 'm':
        if (gdbstub->ops->read_mem != NULL) {
            process_mem_read(gdbstub, payload, args);
        } else {
            conn_send_pktstr(&gdbstub->priv->conn, "");
        }
        break;
    case 'p':
        if (gdbstub->ops->read_reg != NULL) {
            process_reg_read_one(gdbstub, payload, args);
        } else {
            conn_send_pktstr(&gdbstub->priv->conn, "");
        }
        break;
    case 'q':
        process_query(gdbstub, payload);
        break;
    case 's':
        if (gdbstub->ops->stepi != NULL) {
            event = EVENT_STEP;
        } else {
            conn_send_pktstr(&gdbstub->priv->conn, "");
        }
        break;
    case 'v':
        process_vpacket(gdbstub, payload);
        break;
    case 'z':
        if (gdbstub->ops->del_bp != NULL) {
            process_del_break_points(gdbstub, payload, args);
        } else {
            conn_send_pktstr(&gdbstub->priv->conn, "");
        }
        break;
    case '?':
        conn_send_pktstr(&gdbstub->priv->conn, "S05");
        break;
    case 'D':
        event = EVENT_DETACH;
        break;
    case 'G':
        if (gdbstub->ops->write_reg != NULL) {
            process_reg_write(gdbstub, payload, args);
        } else {
            conn_send_pktstr(&gdbstub->priv->conn, "");
        }
        break;
    case 'M':
        if (gdbstub->ops->write_mem != NULL) {
            process_mem_write(gdbstub, payload, args);
        } else {
            conn_send_pktstr(&gdbstub->priv->conn, "");
        }
        break;
    case 'P':
        if (gdbstub->ops->write_reg != NULL) {
            process_reg_write_one(gdbstub, payload, args);
        } else {
            conn_send_pktstr(&gdbstub->priv->conn, "");
        }
        break;
    case 'X':
        if (gdbstub->ops->write_mem != NULL) {
            /* It is important for xwrite to know the end position of packet,
             * because there're escape characters which block us interpreting
             * the packet as a string just like other packets do. */
            process_mem_xwrite(gdbstub, payload,
                               &inpkt->data[inpkt->end_pos - CSUM_SIZE], args);
        } else {
            conn_send_pktstr(&gdbstub->priv->conn, "");
        }
        break;
    case 'Z':
        if (gdbstub->ops->set_bp != NULL) {
            process_set_break_points(gdbstub, payload, args);
        } else {
            conn_send_pktstr(&gdbstub->priv->conn, "");
        }
        break;
    default:
        conn_send_pktstr(&gdbstub->priv->conn, "");
        break;
    }

    return event;
}

static gdb_action_t gdbstub_handle_event(gdbstub_t *gdbstub,
                                         gdb_event_t event,
                                         void *args)
{
    gdb_action_t act = ACT_NONE;

    switch (event) {
    case EVENT_CONT:
        async_io_enable(gdbstub->priv);
        act = gdbstub->ops->cont(args);
        async_io_disable(gdbstub->priv);
        break;
    case EVENT_STEP:
        act = gdbstub->ops->stepi(args);
        break;
    case EVENT_DETACH:
        act = ACT_SHUTDOWN;
        break;
    default:
        break;
    }

    return act;
}

static void gdbstub_act_resume(gdbstub_t *gdbstub)
{
    char packet_str[32];
    sprintf(packet_str, "S%02x", GDB_SIGNAL_TRAP);
    conn_send_pktstr(&gdbstub->priv->conn, packet_str);
}

bool gdbstub_run(gdbstub_t *gdbstub, void *args)
{
    // Bring the user-provided argument in the gdbstub_t structure
    gdbstub->priv->args = args;

    /* Create a thread to receive interrupt when running the gdbstub op */
    if (gdbstub->ops->on_interrupt != NULL && gdbstub->priv->tid == 0) {
        async_io_disable(gdbstub->priv);
#ifdef __MINGW32__
        gdbstub->priv->thnd = CreateThread(NULL, 0, socket_reader, gdbstub, 0, &gdbstub->priv->tid);
#else
        pthread_create(&gdbstub->priv->tid, NULL, (void *) socket_reader,
                       (void *) gdbstub);
#endif
    }

    while (true) {
        conn_recv_packet(&gdbstub->priv->conn);
        packet_t *pkt = conn_pop_packet(&gdbstub->priv->conn);
#ifdef DEBUG
        printf("packet = %s\n", pkt->data);
#endif
        gdb_event_t event = gdbstub_process_packet(gdbstub, pkt, args);
        free(pkt);

        gdb_action_t act = gdbstub_handle_event(gdbstub, event, args);
        switch (act) {
        case ACT_RESUME:
            gdbstub_act_resume(gdbstub);
            break;
        case ACT_SHUTDOWN:
            return true;
        default:
            break;
        }
    }

    return false;
}

void gdbstub_close(gdbstub_t *gdbstub)
{
    /* Use thread ID to make sure the thread was created */
    if (gdbstub->priv->tid != 0) {
        __atomic_store_n(&thread_stop, true, __ATOMIC_RELAXED);
#ifdef __MINGW32__
        WaitForSingleObject(gdbstub->priv->thnd, INFINITE);
#else
        pthread_join(gdbstub->priv->tid, NULL);
#endif
    }

    conn_close(&gdbstub->priv->conn);
    free(gdbstub->priv);
}
